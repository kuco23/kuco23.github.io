<!DOCTYPE html>

<html>
<head>

  <meta name='viewport' content='width=device-width, initial-scale=1.0' charset='utf-8' />
  <title>Graphs and DFS</title>
  <link rel='stylesheet' type='text/css' href='main.css' />
  <script src = '../jquery-3.3.1.min.js'></script>

  <style>
  </style>

  <script>

    // dfs state (backtracking display)
    // edge css display

    function canvasResize() {
      $('#canvus').attr({
        height: window.innerHeight,
        width: window.innerWidth * 0.75
      });
    }

    function help() {
      $('#help').fadeToggle(1000);
    }

    function toggleMode(mode) {
      let modes = ['nodeSelectionMode', 'nodeCreationMode',
                   'dfsMode', 'shortestDistMode'];
      let button = [['TURN ON', 'lime'], ['TURN OFF', 'red']];
      for (let i = 0; i < modes.length; i++) {
        if (mode != modes[i]) {
          document.graph[modes[i]] = false;
          $('#' + modes[i] + 'Btn').html(button[0][0]).css('color', button[0][1]);
        }
      }
      document.graph[mode] = !document.graph[mode];
      let setsTo = button[Number(document.graph[mode])];
      $('#' + mode + 'Btn').html(setsTo[0]).css('color', setsTo[1]);
    }

    $(document).ready(function() {
      $.when(
        $.getScript("graphlib/graph.js")
      ).done(function(){

        canvasResize();
        var canvas = document.getElementById('canvus');
        var context = canvas.getContext('2d');
        document.graph = new Graph(context);

        canvas.addEventListener('click', function(event) {
          document.graph.handleClick(event.pageX, event.pageY);
        });
        document.addEventListener('keydown', function(event) {
          if (event.keyCode == 32) document.graph.linkSelected();
          else if (event.keyCode == 46) document.graph.unlinkSelected();
        });
        window.onresize = function() {
          canvasResize();
          document.graph.reset();
        };
        $('div.options>div>span').click(function() {
          $(this).siblings('div:first').slideToggle(1000);
        });

      });
    });

  </script>

</head>
<body>

<canvas id='canvus' width=500 height=500>
</canvas>

<div class='sidebar'>
  <div class='options'>

    <div>
      <span>Manual Graph Creation</span>
      <div id='manualCreationTools'>
        <button style="color: lime;" onclick = 'toggleMode("nodeCreationMode");'
        id='nodeCreationModeBtn'>
          TURN ON
        </button>
        <button style="color: lime;" onclick='toggleMode("nodeSelectionMode");'
        id='nodeSelectionModeBtn'>
          TURN ON
        </button>
        <button onclick='graph.linkSelected();'>Link</button>
        <button onclick='graph.unlinkSelected();'>Unlink</button>
      </div>
    </div>

    <div>
      <span>Algorithms</span>
      <div id='algorithms'>
        <button style="color: lime;" onclick='toggleMode("dfsMode");'
        id='dfsModeBtn'>
          TURN ON
        </button>
        <button onclick='graph.dfs();'>Run DFS</button>
        <button onclick='graph.bfs();'>Run BFS</button>
        <button onclick='graph.getShortestDistance();'>Find Shortest Distance</buttton>
      </div>
    </div>

    <div>
      <span>Settings</span>
      <div id='settings'>
        <input id='forwardEdgeColor' type='color' value='rgb(50,50,50)'>
        <label for='forwardEdgeColor'>forward edge color</label>
        <input type='submit' value='Submit'>
      </div>
    </div>

  </div>

  <div class='deletionOptions'>
    <div>
      <button onclick='help();'>Toggle Help</button>
      <button onclick='graph.redraw();'>Remove Coloring</button>
      <button onclick='graph.reset();'>Clear Canvas</button>
    </div>
  </div>

</div>

<div id='help'>
  <div>
    Manual Graph Creation:<br />
    Here there are two buttons for toggling node creation and node selection.
    They both have TURN ON written on by default.
    The first one enables the mode in which you can click on a node placeholder
    and thus create it.
    The second button is used for toggling node selection.
    The reason for selecting two nodes is so you can connect them with
    clicking link (hitting enter) or disconnect them by
    clicking unlink (hitting delete).
    <br /><br />
    Algorithms:<br />
    Here the button with TURN ON written on it is used so you can select
    a node in which you want to start the algorithm.
  </div>
</div>

<div id='screenToSmall'>
  Sorry, but your screen is too small
</div>

</body>
</html>
