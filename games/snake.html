<!DOCTYPE html>

<html>
<head>
  <meta name='viewport' content='width=device-width, initial-scale=1.0' charset='utf-8' />
  <title>Snake</title>

  <script src = '../jquery-3.3.1.min.js'></script>
  <link rel="stylesheet" type="text/css" href='https://fonts.googleapis.com/css?family=Bungee Hairline' />
  <link rel="stylesheet" type="text/css" href="snakeCss/snake.css" />

  <style>
  </style>

  <script>

  function endRepr(gameWon) {
    function formatText(text) {
      let formatted = '';
      for (let i = 0; i < text.length; i++) {
        if (text.charAt(i) != ' ') {
          formatted += '<span>' + text.charAt(i) + '</span>';
        } else {
          formatted += text.charAt(i);
        }
      }
      return formatted;
    }
    const div1 = $('#gameOverDiv div:first-child');
    if (gameWon) {
      div1.html(formatText('You Won'));
      div1.css({'text-shadow': '4px 4px 8px lime, 4px 4px 16px white', 'color': 'lime'});
    } else {
      div1.html(formatText('You Lost'));
      div1.css({'text-shadow': '4px 4px 8px FireBrick, 4px 4px 16px white', 'color': 'FireBrick'});
    }
    $('#firstCanvas').fadeOut(1000, function() {$('body').css('background-color', 'black');});
    setTimeout(function() {$('#gameOverDiv').fadeIn(1000);}, 2000);
  };

  $(document).ready(function() {
    $.when(
      $.getScript("snakeLib/collision.js"),
      $.getScript("snakeLib/snakeConstructors.js")
    ).done(function(){

      $('#firstCanvas').attr('width', $(window).width());
      $('#firstCanvas').attr('height', $(window).height());

      const Canvas = document.getElementById('firstCanvas');
      const Context = Canvas.getContext('2d');

      const FRAMESPERSEC = 50;

      const PLAYERSPEED = 2; const PLAYERWIDTH = 20; const PLAYERHEIGHT = 10; const PLAYERCOLOR = 'black';

      const SHOTSPEED = 5; const SHOTWIDTH = 2; const SHOTHEIGHT = 12; const SHOTCOLOR = 'rgba(255, 0, 0, .5)';

      const SNAKESPEED = 1.2; const SNAKELIFE = 1; const SNAKELEN = 10; const SNAKEPARTSIZE = 10; const SNAKECOLOR = 'black';
      const SNAKESTARTX = Canvas.width / 2; const SNAKESTARTY = Canvas.height / 2;

      // game object creation
      const game = new SnakeGame(Canvas, Context, PLAYERSPEED, PLAYERWIDTH, PLAYERHEIGHT, PLAYERCOLOR, 
      SHOTSPEED, SHOTWIDTH, SHOTHEIGHT, SHOTCOLOR, 
      SNAKESPEED, SNAKELIFE, SNAKELEN, SNAKEPARTSIZE, SNAKECOLOR, SNAKESTARTX, SNAKESTARTY);
      game.start();
      
      // game continuation
      while (!game.state && game.interval) { // while game is being played
        null;
      };
      endRepr(this.state); // here game ends
      
    });
  });

  </script>

</head>

<body>

  <canvas id='firstCanvas' height=500 width=750>
  </canvas>

  <div id='gameOverDiv'>
    <div>
    </div>
    <div>
      Play Again: <span onclick = 'location.reload()'>Y</span>/<span>N</span>
    </div>
  </div>

</body>
</html>
